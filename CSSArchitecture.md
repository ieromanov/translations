# Архитектура CSS для современных приложений JavaScript

Моя попытка модернизировать некоторые уроки из CSS-архитектуры и применить их в контексте современных JavaScript-приложений.

Однажды вечером я отправился на митап по JavaScript в Сиднее и задал вопрос «Сколько людей знают, что такое CSS архитектура?». Комната была полна людей с разным опытом. Я думал, что, по крайней мере, около четверти могут знать, о чем я говорю. Я надеялся на большее. К моему удивлению, только горстка людей подняла руку.

Затем я спросил :"многие ли люди считают, что трудности, с которыми они сталкиваются при написании маштабного CSS, были в значительной степени решены CSS-in-JS?". Они были не глупы, и знали, что этот вопрос был подставой, тем не менее, многие из них подняли руку.

Судя по взглядам в комнате, я думаю, что гораздо больше людей хотели признать. По крайней мере, я думаю, что многие люди считают, что архитектура CSS больше не актуальна в контексте современных JavaScript приложений.

Эту точку зрения очень любезно изложил мне Алекс Лоуден в Твиттере:
> «Стилизованные компоненты и т.д. полностью избавили меня от необходимости довать имена классов. Теперь, когда стили включены в мои компоненты (по крайней мере, для меня), это больше не похоже на проблему архитектуры стилей?»

Это не для критики этой точки зрения; Все верно! Алекс говорит, что инструменты помогли облегчить некоторые проблемы, с которыми он столкнулся при работе с CSS (в частности, специфичность). Задача сейчас связана с компонентами в приложении.

Я понимаю эту точку зрения, но я нахожу интересным, когда люди видят имена классов и компонентов как совершенно разные проблемы. Имена классов и компонентов - это просто разные способы составления пользовательских интерфейсов. По-прежнему существует много проблем, связанных с созданием хороших многоразовых и масштабируемых интерфейсных систем, независимо от того, как вы их объедините.

Эти проблемы не новы. На самом деле, есть несколько хорошо зарекомендовавших себя решений в архитектуре CSS, которые можно легко перенести в системы стилей на основе компонентов. Так почему же так мало людей говорят об этом? И почему еще много людей совершенно не знают эту тему?

Я верю, что этому способствовало многое, и стоит задуматься о том, как мы к этому пришли ...

## Как мы к этому пришли

Я полагаю, что первоначальный ответ на CSS-в-JS от многих лидеров в сообществе CSS не помогал пониманию и обмену знаниями. Я часто слышал комментарии типа «Люди (то есть молодые JavaScript разработчики) просто должны лучше изучать CSS». Людям, обладающим знаниями о CSS архитектуре, необходимо лучше сформулировать этот опыт таким образом, чтобы он был доступен и актуален для молодых разработчиков. Если честно, сообщество CSS провалилось в этом.

Но это не так просто. Есть некоторые нечеловеческие факторы и контекст, который мы должны учитывать.

До появления JavaScript компонентов. Сильные и очевидные соглашения об именах в БЭМ дали разработчикам систему, которой нужно следовать, что помогло избежать конфликтов специфичности в «ужасающей глобальной области» CSS. Одного этого было достаточно для многих людей, чтобы использовать БЭМ. Вы можете получить достаточно хорошие результаты, не обязательно понимать нюансы, стоящие за концепциями.

Когда JavaScript инструменты предоставили лучшее решение, чем люди, следуя соглашениям об именах, они открыли разработку пользовательского интерфейса для более широкого круга разработчиков, которые ранее меньше интересовались или стремились сосредоточиться на архитектуре стиля.

Бизнес прыгнул выше головы. Они полагали, что было бы дешевле нанять разработчиков, которые могли бы «сделать все», и получили то, что, по их мнению, было адекватным результатом, недоинвестировав в специалистов по пользовательскому интерфейсу. Некоторые разработчики, которые провели половину карьеры, совершенствуя навыки в этой области, чувствовали угрозу.

В то же время, разработчики, работающие в области роста и возможностей, иногда могут игнорировать навыки, которые не были актуальными. Были гордость, ажиотаж и нежелание признать, что новые инструменты и подходы не всегда приводили к созданию лучшей, более переиспользуемой архитектуры интерфейса.

Я консультировался в этой области в течение последних 5 лет, и я видел много разных систем для создания пользовательских интерфейсов с компонентной архитектурой. Реальность такова, что хотя некоторые аспекты создания крупномасштабных JavaScript приложений проще, обещание более совершенных и более повторно используемых компонентов пользовательского интерфейса не было предоставлено. Интерфейсная архитектура более разнообразна в подходе, а результаты менее пригодны для повторного использования, чем это было до появления JavaScript инструментов.

Некоторые люди могут оспаривать это, но я видел достаточно примеров, чтобы считать это объективной правдой. То, что я видел, это:

* почти у каждой команды свой подход,
* 90% компонентов не могут быть переиспользованы,
* визуальные изменения часто бывают трудными, медленными и дорогими,
* труднее, **чем когда-либо**, читать и понимать стили.

Где-то в этом потоке мы потеряли более мелкие причины, стоящие за соглашениями об именах

Цель этого состояла в том, чтобы дать контекст, а не обвинять (это немного вина каждого). Итак, давайте подведем черту и посмотрим, как применить некоторые уроки из архитектуры CSS к современным JavaScript приложениям.

## CSS архитектура для компонентов

Прежде всего, мы должны рассмотреть, что делает разумные абстракции в разработке пользовательского интерфейса. У OOCSS, SMACSS и BEM общий язык, когда они говорят о разных частях компонента пользовательского интерфейса. Я могу обобщить их как:

* Компоновка,
* Дизайн,
* Пользовательский интерфейс и
* Логика применения

Если переиспользование или долгосрочная возможность изменения важны, полезно хранить эти проблемы отдельно. Тем не менее, обычно команды не проектируют свои библиотеки компонентов.

Компоненты могут делать много вещей, они могут извлекать данные, они могут отображать HTML, они могут вызывать функции для выполнения бизнес-логики и управления состоянием приложения. Иногда один компонент делает все это. Как правило, ответственность за компонент должна быть незначительной. Люди рисуют рамки вокруг визуальных границ дизайна, а затем смешивают это с логикой приложения. Вот так строится большинство компонентов. Мы можем сделать лучше.

БЭМ дал семантическое значение именам классов, и одним из самых больших невиданных значений в этом отношении было то, что мы могли  передать свою задумку другим разработчикам в рамках команд и даже проектов. Если вы знаете БЭМ, вы можете посмотреть имя класса, например, `button--state-success` и сразу понять что это модификатор для класса кнопки.

Этот вид семантического значения остро необходим для компонентов.

Имея это в виду, давайте рассмотрим различные части компонента пользовательского интерфейса, определенные в методологиях архитектуры CSS, и переопределим их с точки зрения архитектуры компонентов.

## Компоненты

Найдите способ разбиватьваше приложение на компоненты. Это может быть комментарий в файле, соглашение об именах или организация компонентов в папках ... это не имеет значения. Важно то, что нам нужен способ быстро донести свои намерения до других разработчиков.

Когда у нас есть общее понимание того, что такое компонент, мы можем обеспечить соблюдение правил при код-ревью или линтинге.

Компоненты:

* ответственнен только за сам компонент и ничего более
* никогда не следует применять какие-либо глобальные стили
* не должно содержать никакой логики приложения
* ответственнен за расположение дочерних элементов

Последний пункт может быть немного запутанным на первый взгляд. Почему дети, а не сами?

В современном CSS есть две части, которые способствуют верстке:
* Родительский элемент, который устанавливает режим отображения
* Дочерний элемент, который участвует в отображении родительских элементов.
